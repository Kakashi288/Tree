<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Family Tree Visualization</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
</head>
<body>
    <div class="family-equation">‚Ñ± = ‚àë<sub>i=1</sub><sup>‚àû</sup> G<sub>i</sub>(L,M,T)</div>

    <!-- Mataji Image -->
    <img src="Images/Mataji.jpg" alt="Mataji" class="mataji-image" id="matajiImage">

    <!-- Ganesh Image -->
    <img src="Images/Ganesh.jpg" alt="Ganesh" class="ganesh-image" id="ganeshImage">

    <!-- Navigation Menu Toggle -->
    <button class="nav-menu-toggle" id="navMenuToggle" aria-label="" title="">
        <span></span>
        <span></span>
        <span></span>
    </button>

    <!-- Navigation Menu Overlay -->
    <div class="nav-menu-overlay" id="navMenuOverlay"></div>

    <!-- Navigation Menu -->
    <nav class="nav-menu" id="navMenu">
        <h2>Navigation</h2>
        <a href="landing.html" class="nav-menu-item">üè† Home</a>
        <a href="tree.html" class="nav-menu-item active-page">üå≥ Family Tree</a>
        <a href="family-data.html" class="nav-menu-item">üìä Family Data</a>
        <a href="family-history.html" class="nav-menu-item">üèõÔ∏è Family History</a>
        <a href="family-timeline.html" class="nav-menu-item">üìñ Family Timeline</a>
    </nav>

    <div class="tree-container">
        <svg id="tree-canvas"></svg>
    </div>
    <script src="script.js?v=20260111b"></script>

    <!-- Navigation Menu Toggle Script -->
    <script>
        const navMenuToggle = document.getElementById('navMenuToggle');
        const navMenu = document.getElementById('navMenu');
        const navMenuOverlay = document.getElementById('navMenuOverlay');

        navMenuToggle.addEventListener('click', function() {
            navMenuToggle.classList.toggle('active');
            navMenu.classList.toggle('active');
            navMenuOverlay.classList.toggle('active');
        });

        navMenuOverlay.addEventListener('click', function() {
            navMenuToggle.classList.remove('active');
            navMenu.classList.remove('active');
            navMenuOverlay.classList.remove('active');
        });

        // Close nav menu on orientation change to prevent freezing
        window.addEventListener('orientationchange', function() {
            // Force close immediately - no transition delay
            navMenuToggle.classList.remove('active');
            navMenu.classList.remove('active');
            navMenuOverlay.classList.remove('active');

            // Force hide menu during rotation to prevent flickering
            navMenu.style.display = 'none';
            navMenuOverlay.style.display = 'none';

            // Re-enable display after a short delay (after orientation settles)
            setTimeout(function() {
                navMenu.style.display = '';
                navMenuOverlay.style.display = '';
            }, 500);
        });

        // Also close on resize (backup for devices that don't fire orientationchange)
        let resizeTimeout;
        window.addEventListener('resize', function() {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(function() {
                // Check if orientation actually changed (significant size swap)
                const currentWidth = window.innerWidth;
                const currentHeight = window.innerHeight;
                const isNowLandscape = currentWidth > currentHeight;

                // Close menu if orientation changed
                if (window.lastOrientation !== isNowLandscape) {
                    navMenuToggle.classList.remove('active');
                    navMenu.classList.remove('active');
                    navMenuOverlay.classList.remove('active');

                    // Force hide during transition
                    navMenu.style.display = 'none';
                    navMenuOverlay.style.display = 'none';

                    setTimeout(function() {
                        navMenu.style.display = '';
                        navMenuOverlay.style.display = '';
                    }, 300);

                    window.lastOrientation = isNowLandscape;
                }
            }, 100);
        });

        // Initialize orientation tracking
        window.lastOrientation = window.innerWidth > window.innerHeight;
    </script>

    <!-- iOS Keyboard Fix Script -->
    <script>
        // Fix iOS keyboard causing nav button shift
        // When the keyboard appears, iOS Safari can cause position: fixed elements to shift

        // Store original viewport width
        let originalViewportWidth = window.innerWidth;

        // Function to prevent layout shift when keyboard appears
        function preventKeyboardShift() {
            // Lock the viewport width
            document.documentElement.style.setProperty('--viewport-width', `${originalViewportWidth}px`);

            // Prevent horizontal scroll
            document.body.style.overflowX = 'hidden';
            document.documentElement.style.overflowX = 'hidden';

            // Ensure body width stays fixed
            document.body.style.width = `${originalViewportWidth}px`;
            document.body.style.maxWidth = `${originalViewportWidth}px`;
        }

        // Function to restore normal behavior
        function restoreLayout() {
            document.body.style.overflowX = '';
            document.documentElement.style.overflowX = '';
            document.body.style.width = '';
            document.body.style.maxWidth = '';
        }

        // Wait for search input to be created by script.js
        setTimeout(function() {
            const searchInput = document.getElementById('search-input');

            if (searchInput) {
                // When search input gets focus (keyboard appears)
                searchInput.addEventListener('focus', function() {
                    // Only apply fix on iOS devices
                    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
                    if (isIOS) {
                        preventKeyboardShift();
                    }
                });

                // When search input loses focus (keyboard disappears)
                searchInput.addEventListener('blur', function() {
                    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
                    if (isIOS) {
                        setTimeout(restoreLayout, 100); // Small delay to let keyboard close
                    }
                });
            }
        }, 500); // Wait for script.js to create the search input

        // Update viewport width on orientation change
        window.addEventListener('orientationchange', function() {
            setTimeout(function() {
                originalViewportWidth = window.innerWidth;
            }, 300);
        });
    </script>

    <!-- Page Load Animation Script -->
    <script>
        // Trigger animations on page load
        window.addEventListener('load', function() {
            // Animate tree container
            const treeContainer = document.querySelector('.tree-container');
            if (treeContainer) treeContainer.classList.add('animate-in');

            // Animate images
            const matajiImage = document.getElementById('matajiImage');
            if (matajiImage) matajiImage.classList.add('animate-in');

            const ganeshImage = document.getElementById('ganeshImage');
            if (ganeshImage) ganeshImage.classList.add('animate-in');

            // Animate family equation
            const familyEquation = document.querySelector('body > .family-equation');
            if (familyEquation) familyEquation.classList.add('animate-in');

            // Animate zoom controls (wait a bit for them to be created by script.js)
            setTimeout(function() {
                const zoomControls = document.querySelector('.zoom-controls');
                if (zoomControls) zoomControls.classList.add('animate-in');

                const searchContainer = document.querySelector('.search-container');
                if (searchContainer) searchContainer.classList.add('animate-in');
            }, 100);
        });
    </script>
</body>
</html>
